!function(e,t){"use strict";const n=Symbol("invisible:callback"),i=Symbol("invisible:duration"),r="performance"in e&&a(performance.now);function o(){}function a(e){return"function"==typeof e}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(e){let n;const{create:r,revoke:l,elapsedTime:s}=Object.assign({},c(e)?e:{});return[r,l,s].every(a)?{invisible(){!function(){n||(n=`__${btoa(String(Math.random())).replace(/[+=\/]/g,"").slice(-3)}__`);r(n,Date.now())}()},visible(){const e=+s(n,Date.now());if(e){const n=Object.create(null,{[i]:{get:()=>e}}),r=new CustomEvent("invisible:duration",{bubbles:!1,cancelable:!1,detail:Object.defineProperties(n,{exact:{enumerable:!0,value:e},seconds:{enumerable:!0,value:Math.floor(e/1e3)}})});t.dispatchEvent(r)}!function(){n&&l(n,Date.now());n=void 0}()}}:{invisible:o,visible:o}}t.addEventListener("visibilitychange",(()=>{const{visible:e,invisible:n}=(r?function(){return l({create:(e,t)=>performance.mark(e),revoke:(e,t)=>performance.clearMarks(e),elapsedTime(e,t){const n=performance.getEntriesByType("mark").filter(({name:t})=>t===e)[0];if(n)return performance.now()-n.startTime}})}:function(){return l({create:(e,t)=>localStorage.setItem(e,t),revoke:(e,t)=>localStorage.removeItem(e),elapsedTime(e,t){const n=localStorage.getItem(e);if(n)return t-n}})})();return function(){("visible"===t.visibilityState?e:n)()}})()),Object.defineProperties(e,{registerInvisibleDurationCallback:{enumerable:!0,value:function(e){if(a(e)){const r=n=>{const r=n.detail;if(c(r)&&n.target===t){const{exact:t,seconds:n}=r;t&&t===r[i]&&e({exact:t,seconds:n})}};return t.addEventListener("invisible:duration",r),Object.defineProperties(Object.create(null),{[n]:{value:function(){return t.removeEventListener("invisible:duration",r),!0}}})}return null}},unregisterInvisibleDurationCallback:{enumerable:!0,value:function(e){return!(!c(e)||!a(e[n]))&&e[n]()}}})}(window,document);